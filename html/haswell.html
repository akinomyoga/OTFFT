<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
    <head>
        <meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=EUC-JP">
        <meta HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
        <meta HTTP-EQUIV="Content-Script-Type" CONTENT="text/javascript">
        <meta NAME="description" CONTENT="Haswell での OTFFT ベンチマーク">
        <meta NAME="keywords" CONTENT="otfft,haswell,benchmark">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta HTTP-EQUIV="refresh" content="10; url=node4.html">
        <link rel="stylesheet" href="stockham.css" type="text/css">
<!--
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
-->
        <script type="text/javascript" src="ga.js"></script>
        <title>Haswell Core i7 による OTFFT ベンチマーク</title>
    </head>
    <body>
        <a href="node7.html">OTFFT ダウンロード</a>
        <hr>
        <h2>Haswell Core i7 による OTFFT ベンチマーク</h2>
        <p style="color: red;">
        　このページの情報は古くなっています。
        将来削除されるかもしれません。
        新しいページへ１０秒後に自動的に移動します。
        うまく移動しない場合は、<a href="node4.html">このリンク</a>
        からどうそ。
        </p>
        <p>
        　以前のベンチマークでは、
        FFTW のマルチスレッド処理を正しく実装せず、
        FFTW の性能を不当に低く表示したベンチマーク結果を示して
        申し訳ありませんでした。その後、MacBook Pro 15 inch Late 2013
        モデルを手に入れたので、改めて FFTW のマルチスレッド処理を
        正しく実装し直してベンチマークしてみました。
        </p>
        <p>
        　それでは、ベンチマーク結果を示しましょう。環境は MacBook Pro 15 inch
        Late 2013 (Haswell Core i7)上の Linux(Fedora 20)で、gcc 4.8.2
        でコンパイルしてベンチマークしました。比較に使った FFTW のバージョンは
        3.3.3 です。FFTW では FFTW_ESTIMATE を用いています。
        まずは FFT 用オブジェクト(FFTW のプラン等)の初期化時間を含まない
        ベンチマーク結果を示します。
        </p>
<pre><code>
------+-----------+-----------------+-----------------+-----------------
length|FFTW3[usec]|   OOURA   [usec]| SimpleFFT [usec]|   OTFFT   [usec]
------+-----------+-----------------+-----------------+-----------------
2^( 1)|       0.04|       0.02( 44%)|       0.02( 38%)|       0.02( 41%)
2^( 2)|       0.05|       0.02( 49%)|       0.04( 80%)|       0.02( 41%)
2^( 3)|       0.08|       0.06( 81%)|       0.08(100%)|       0.04( 51%)
2^( 4)|       0.15|       0.13( 89%)|       0.19(132%)|       0.06( 38%)
2^( 5)|       0.27|       0.39(147%)|       0.37(139%)|       0.13( 49%)
2^( 6)|       0.44|       0.93(212%)|       0.99(225%)|       0.34( 77%)
2^( 7)|       0.84|       1.96(233%)|       1.91(227%)|       0.60( 71%)
2^( 8)|       1.72|       4.67(271%)|       4.88(284%)|       1.31( 76%)
2^( 9)|       3.77|       9.89(263%)|       9.49(252%)|       2.95( 78%)
2^(10)|       9.09|      22.92(252%)|      23.71(261%)|       7.71( 85%)
2^(11)|      22.08|      47.56(215%)|      47.59(215%)|      27.19(123%)
2^(12)|      63.68|     108.45(170%)|     129.57(203%)|      59.90( 94%)
2^(13)|     157.68|     327.06(207%)|     273.69(174%)|      93.31( 59%)
2^(14)|     342.62|     625.97(183%)|     642.90(188%)|     178.25( 52%)
2^(15)|     701.34|    1126.49(161%)|    1302.30(186%)|     380.20( 54%)
2^(16)|    1587.10|    1722.75(109%)|    4695.83(296%)|     547.16( 34%)
2^(17)|    3127.80|    2806.73( 90%)|    6529.83(209%)|    1300.73( 42%)
2^(18)|    6444.85|    7423.75(115%)|   16417.70(255%)|    5115.35( 79%)
2^(19)|   16535.22|   15570.78( 94%)|   39817.78(241%)|   10342.89( 63%)
2^(20)|   35693.00|   36385.25(102%)|  100132.00(281%)|   24356.75( 68%)
2^(21)|   57022.50|   68028.00(119%)|  231618.50(406%)|   46991.00( 82%)
2^(22)|  162041.00|  105734.00( 65%)|  568397.00(351%)|  139008.00( 86%)
------+-----------+-----------------+-----------------+-----------------
</code></pre>
        <p>
        　どうでしょう。ほとんどのサイズで OTFFT の方が速いです。
        Haswell Good Job! まあ、私はほとんどがんばってはいないんですけどね。
        OTFFT も多少修正してバージョンアップしましたが(^^;
        </p>
        <p>
        　このページしか見てない人には意味が分からないかもしれないので
        一応解説しておくと、このベンチマークは私が開発した FFT ライブラリの
        OTFFT と FFTW の比較を行ったものです。FFTW3 の欄は言うまでもなく
        FFTW で FFT した時の処理時間をマイクロ秒で表したものです。OOURA の欄は
        有名な大浦さんの FFT ライブラリでの処理時間、SimpleFFT は素朴な
        ４基底の FFT での処理時間、そして OTFFT の欄が OTFFT での処理時間です。
        括弧の中の数値は FFTW3 の処理時間に対して、それぞれの FFT が
        何パーセントの処理時間になるかを表しています。
        </p>
        <p>
        　もう一つ、実行時間計測に FFT 用のオブジェクトの初期化の時間も含んだ
        ベンチマークも示しておきます。ある意味こちらの時間が本当に必要な実行時間
        を示しているとも言えます。FFT 用オブジェクトを初期化した後、FFT を
        一回しか実行しない場合はこちらの時間を気にする必要があります。
        </p>
<pre><code>
------+-----------+-----------------+-----------------+-----------------
length|FFTW3[usec]|   OOURA   [usec]| SimpleFFT [usec]|   OTFFT   [usec]
------+-----------+-----------------+-----------------+-----------------
2^( 4)|       7.11|       0.37(  5%)|       1.01( 14%)|       0.35(  5%)
2^( 5)|       7.13|       0.84( 12%)|       1.94( 27%)|       0.54(  8%)
2^( 6)|      15.71|       1.50( 10%)|       4.02( 26%)|       1.03(  7%)
2^( 7)|      17.10|       2.98( 17%)|       7.91( 46%)|       1.78( 10%)
2^( 8)|      18.83|       6.22( 33%)|      16.44( 87%)|       3.25( 17%)
2^( 9)|      24.17|      13.15( 54%)|      32.29(134%)|       6.51( 27%)
2^(10)|      30.97|      27.83( 90%)|      69.41(224%)|      14.70( 47%)
2^(11)|      51.15|      62.79(123%)|     141.51(277%)|      40.51( 79%)
2^(12)|     114.54|     136.06(119%)|     311.56(272%)|      84.13( 73%)
2^(13)|     233.45|     427.53(183%)|     650.33(279%)|     254.53(109%)
2^(14)|     776.16|     714.14( 92%)|    1368.13(176%)|     382.85( 49%)
2^(15)|    1142.15|    1523.51(133%)|    2761.90(242%)|     759.92( 67%)
2^(16)|    2519.15|    3200.20(127%)|    6496.34(258%)|    2244.06( 89%)
2^(17)|    4373.10|    5149.05(118%)|   12416.24(284%)|    3396.15( 78%)
2^(18)|    9278.00|    9938.00(107%)|   28270.40(305%)|    6627.00( 71%)
2^(19)|   19414.78|   20341.56(105%)|   62570.44(322%)|   15615.56( 80%)
2^(20)|   36512.25|   35827.25( 98%)|  155373.75(426%)|   34223.50( 94%)
2^(21)|   75296.00|   79176.50(105%)|  340546.00(452%)|   70505.00( 94%)
2^(22)|  187794.00|  131439.00( 70%)|  722067.00(384%)|  148955.00( 79%)
------+-----------+-----------------+-----------------+-----------------
</code></pre>
        <p>
        　どちらのベンチマークも、実は OTFFT に有利になるよう各種パラメータを
        調整してあることを白状しておきましょう。gcc の最適化オプションで、
        -march=native -mtune=native を使いたかったのですが、ベンチマーク結果が
        安定しなかったので、-march=core-avx-i -mtune=core-avx-i を使っています。
        また、同じベンチマークを何回か実行し、OTFFT の成績が最もよくなった
        結果を選んでいます。あと、実行時には明示的に環境変数 OMP_NUM_THREADS
        を 8 に設定してあります。
        </p>
        <hr>
        <a href="node7.html">OTFFT ダウンロード</a>
    </body>
    <IMG SRC="http://www.sannet.ne.jp/counter/c0.gif" ALT="0"><IMG SRC="http://www.sannet.ne.jp/counter/c0.gif" ALT="0"><IMG SRC="http://www.sannet.ne.jp/counter/c7.gif" ALT="7"><IMG SRC="http://www.sannet.ne.jp/counter/c4.gif" ALT="4"><IMG SRC="http://www.sannet.ne.jp/counter/c0.gif" ALT="0">
</html>
